<html>
<head>
<title>Main.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #499cd5;}
.s1 { color: #d4d4d4;}
.s2 { color: #cd9069;}
.s3 { color: #b4cda8;}
.s4 { color: #699856;}
</style>
</head>
<body bgcolor="#1e1e1e">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Main.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">org.example;</span>

<span class="s0">import </span><span class="s1">org.pcap4j.core.PcapNativeException;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.core.PcapNetworkInterface;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.core.Pcaps;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.core.PcapHandle;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.core.PcapNetworkInterface.PromiscuousMode;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.packet.Packet;</span>
<span class="s0">import </span><span class="s1">org.pcap4j.packet.IpV4Packet;</span>

<span class="s0">import </span><span class="s1">javax.swing.*;</span>
<span class="s0">import </span><span class="s1">java.awt.*;</span>
<span class="s0">import </span><span class="s1">java.awt.event.ActionEvent;</span>
<span class="s0">import </span><span class="s1">java.awt.event.ActionListener;</span>
<span class="s0">import </span><span class="s1">java.io.IOException;</span>
<span class="s0">import </span><span class="s1">java.net.Inet4Address;</span>
<span class="s0">import </span><span class="s1">java.net.InetAddress;</span>
<span class="s0">import </span><span class="s1">java.util.Scanner;</span>

<span class="s0">public class </span><span class="s1">Main {</span>

    <span class="s0">public static void </span><span class="s1">main(String[] args) </span><span class="s0">throws </span><span class="s1">Exception {</span>

        <span class="s1">JFrame frame = </span><span class="s0">new </span><span class="s1">JFrame(</span><span class="s2">&quot;PCAP4J Packet Tool&quot;</span><span class="s1">);</span>
        <span class="s1">frame.setSize(</span><span class="s3">600</span><span class="s1">, </span><span class="s3">400</span><span class="s1">);</span>
        <span class="s1">frame.setLayout(</span><span class="s0">null</span><span class="s1">);</span>
        <span class="s1">frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); </span><span class="s4">// Ensure the application exits on close</span>


        <span class="s1">JTextField textField = </span><span class="s0">new </span><span class="s1">JTextField();</span>
        <span class="s1">textField.setBounds(</span><span class="s3">50</span><span class="s1">, </span><span class="s3">50</span><span class="s1">, </span><span class="s3">150</span><span class="s1">, </span><span class="s3">30</span><span class="s1">);</span>
        <span class="s1">frame.add(textField);</span>


        <span class="s1">JTextArea packetDisplay = </span><span class="s0">new </span><span class="s1">JTextArea();</span>
        <span class="s1">packetDisplay.setBounds(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">100</span><span class="s1">, </span><span class="s3">600</span><span class="s1">, </span><span class="s3">400</span><span class="s1">);</span>
        <span class="s1">packetDisplay.setEditable(</span><span class="s0">false</span><span class="s1">);</span>
        <span class="s1">frame.add(packetDisplay);</span>

        <span class="s1">JButton enter = </span><span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Enter Interface IP&quot;</span><span class="s1">);</span>
        <span class="s1">enter.setBounds(</span><span class="s3">210</span><span class="s1">, </span><span class="s3">50</span><span class="s1">, </span><span class="s3">100</span><span class="s1">, </span><span class="s3">30</span><span class="s1">);</span>
        <span class="s1">frame.add(enter);</span>

        <span class="s1">frame.setVisible(</span><span class="s0">true</span><span class="s1">);</span>


        <span class="s1">enter.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener() {</span>
            <span class="s1">@Override</span>
            <span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e) {</span>

                    <span class="s1">Scanner scanner = </span><span class="s0">new </span><span class="s1">Scanner(System.in);</span>
                    <span class="s1">String ipOfInterface = textField.getText();</span>

                    <span class="s0">try </span><span class="s1">{</span>
                        <span class="s1">InetAddress addr = InetAddress.getByName(ipOfInterface);</span>
                        <span class="s1">PcapNetworkInterface nif = Pcaps.getDevByAddress(addr);</span>

                        <span class="s0">if </span><span class="s1">(nif != </span><span class="s0">null</span><span class="s1">) {</span>
                            <span class="s1">System.out.println(</span><span class="s2">&quot;Interface is valid! :D&quot;</span><span class="s1">);</span>
                            <span class="s1">frame.setBackground(Color.GREEN);</span>
                            <span class="s4">// A pcap handle provides you APIs to capture packets, send packets, and so on.</span>
                            <span class="s0">try </span><span class="s1">{</span>
                                <span class="s0">int </span><span class="s1">snapLen = </span><span class="s3">65536</span><span class="s1">;</span>
                                <span class="s1">PromiscuousMode mode = PromiscuousMode.PROMISCUOUS;</span>
                                <span class="s0">int </span><span class="s1">timeout = </span><span class="s3">10</span><span class="s1">;</span>
                                <span class="s1">PcapHandle handle = nif.openLive(snapLen, mode, timeout);</span>

                                <span class="s1">Packet packet = handle.getNextPacketEx();</span>
                                <span class="s1">handle.close();</span>

                                <span class="s4">// Check if the packet is an IPv4 packet</span>
                                <span class="s4">//Packets consist of headers and payloads. API allows you to get info from the headers</span>
                                <span class="s1">IpV4Packet ipV4Packet = packet.get(IpV4Packet.</span><span class="s0">class</span><span class="s1">);</span>
                                <span class="s1">Inet4Address srcAddr = ipV4Packet.getHeader().getSrcAddr();</span>
                            <span class="s1">} </span><span class="s0">catch </span><span class="s1">(Exception ex) {</span>
                                <span class="s1">System.out.println(</span><span class="s2">&quot;Error while analyzing packets: &quot; </span><span class="s1">+ ex.getMessage());</span>
                            <span class="s1">}</span>

                        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                            <span class="s1">System.out.println(</span><span class="s2">&quot;Wrong interface :(&quot;</span><span class="s1">);</span>
                            <span class="s1">frame.setBackground(Color.RED);</span>
                        <span class="s1">}</span>
                    <span class="s1">} </span><span class="s0">catch </span><span class="s1">(IOException | PcapNativeException exception) {</span>
                        <span class="s1">System.out.println(</span><span class="s2">&quot;Error:&quot; </span><span class="s1">+ exception.getMessage());</span>
                        <span class="s1">frame.setBackground(Color.red);</span>
                    <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">});</span>
    <span class="s1">};</span>
<span class="s1">}</span>
</pre>
</body>
</html>